@main("VDJdb: annotations: upload") {

    <!-- Select styling -->
    <script src="@routes.Assets.at("lib/select/js/select.js")" type="text/javascript"></script>
    <link href="@routes.Assets.at("lib/select/css/style.css")" rel="stylesheet">

    <script src="@routes.Assets.at("lib/FileUpload/jquery.ui.widget.js")" type="text/javascript"></script>
    <script src="@routes.Assets.at("lib/FileUpload/jquery.iframe-transport.js")" type="text/javascript"></script>
    <script src="@routes.Assets.at("lib/FileUpload/jquery.fileupload.js")" type="text/javascript"></script>



    <script src="@routes.Assets.at("javascripts/user.js")" type="text/javascript"></script>
    <script src="@routes.Assets.at("javascripts/blockpage.js")" type="text/javascript"></script>
    <script src="@routes.Assets.at("javascripts/intersection/upload.js")" type="text/javascript"></script>

    @navbar()
    <div class="wrapper" ng-app="uploadPage">
        <block></block>
        <upload>
            <div class="container">
                <div class="row">
                    <div class="box box-solid flat">
                        <div class="box-header with-border">
                            Upload your files here
                        </div>
                        <div class="box-body text-center">
                            <p ng-if="!isNewFilesExists()">Click 'Add file' button</p>
                            <table class="table" ng-if="isNewFilesExists()">
                                <thead>
                                    <tr>
                                        <th class="file_name_th">File name</th>
                                        <th class="software_th">Software type</th>
                                        <th class="progress_th">Progress</th>
                                        <th class="tooltip_th"></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td></td>
                                        <td ng-click="commonSoftwareType()">
                                            <select class="dropdown" id="commonSoftwareType" name="commonSoftwareId">
                                                <option>Please select software type:</option>
                                                <option ng-repeat="software in softwareTypes" value="{{ software.dbName }}">{{ software.clientName }}</option>
                                            </select>
                                        </td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                    <tr ng-repeat="file in newFiles" ng-class="{'danger':isError(file), 'success':isSuccess(file), 'warning':isRemoved(file)}" on-last-repeat>
                                        <td width="30%">
                                            <input ng-model="file.fileName" type="text" value="file.fileName" ng-show="isWaitForUpload(file)" class="form-control"
                                            ng-class="{'input_invalid_name':!isNameValid(file)}" tooltip="Name tooltip" tooltip-placement="top">
                                            <text ng-hide="isWaitForUpload(file)">{{ file.fileName }}</text>
                                        </td>
                                        <td width="30%">
                                            <div ng-show="isWaitForUpload(file)">
                                            <select class="dropdown" id="software_file_{{ file.uid }}" name="fileSoftwareId">
                                                <option>Please select software type:</option>
                                                <option ng-repeat="software in softwareTypes" value="{{ software.dbName }}">{{ software.clientName }}</option>
                                            </select>
                                            </div>
                                            <text ng-hide="isWaitForUpload(file)">{{ file.softwareType }}</text>
                                        </td>
                                        <td width="30%">
                                            <div class="progress progress-sm mbn" ng-show="isOk(file) && !isRemoved(file)">
                                                <div role="progressbar" style="width: {{ file.progress }}%" class="progress-bar progress-bar-success"></div>
                                            </div>
                                            <text ng-show="isError(file)">{{ file.errorTooltip }}</text>
                                            <text ng-hide="isWaitForUpload(file) || isError(file)">{{ file.tooltip }}</text>
                                        </td>
                                        <td width="10%">
                                            <button class="btn btn-flat btn-sm bg-purple" ng-click="uploadFile(file)" ng-show="isWaitForUpload(file) && isUploadValid(file)">Upload</button>
                                            <button class="btn btn-flat btn-sm bg-purple" ng-click="removeFile(file)" ng-show="isWaitForUpload(file)">X</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="box-footer">
                            <button class="btn btn-flat bg-purple btn-sm" ng-click="addNewButtonClick()">Add file</button>
                            <button class="btn btn-red pull-right bg-purple btn-sm" ng-click="uploadAll()" ng-show="isWaitingExists()">Upload all</button>
                            <form id="fileupload" method="POST" action="" enctype="multipart/form-data" class="hidden_fileupload_form">
                                <input type="file" name="file" multiple/>
                            </form>
                        </div>
                    </div>
                    <div class="box box-solid flat">
                        <div class="box-body">
                            <a href="@routes.IntersectionAPI.index()">Go to annotations page</a>
                        </div>
                    </div>
                </div>
            </div>
        </upload>
    </div>
}